define(["underscore","cloud-foundry-client/api","stackato-client-extension/lib/cluster","stackato-client-extension/lib/config","stackato-client-extension/lib/export","stackato-client-extension/lib/app-store","stackato-client-extension/lib/app-stores","stackato-client-extension/lib/settings","stackato-client-extension/lib/stream","stackato-client-extension/lib/cloud-events","stackato-client-extension/lib/zones","stackato-client-extension/lib/availability-zones"],function(t,n,e,i,o,s,a,l,r,c,u,f){return{extend:function(){n.prototype.initialize=function(){this.cluster=new e(this),this.config=new i(this),this.export=new o(this),this.app_store=new s(this),this.app_stores=new a(this),this.settings=new l(this),this.cloud_events=new c(this),this.stream=new r(this),this.zones=new u(this),this.availability_zones=new f(this)},n.prototype.getStackatoInfo=function(t,n){"function"==typeof t&&"undefined"==typeof n&&(n=t,t=null),t=t||{},t.status_code=200,this.get("/v2/stackato/info",t,function(t,e){n(t,e?e.body:null)})},n.prototype.getStackatoStatus=function(t,n){"function"==typeof t&&"undefined"==typeof n&&(n=t,t=null),t=t||{},t.status_code=200,this.get("/v2/stackato/status",t,function(t,e){n(t,e?e.body:null)})},n.prototype.logout=function(t,n){"function"==typeof t&&"undefined"==typeof n&&(n=t,t=null),t=t||{},t.status_code=204;var e=this;this.getAuthorizationEndpoint(function(i,o){if(i)return n(i);var s=o+"/oauth/token";e.delete_(s,t,function(t,e){return t?n(t):void n(null,e.body)})})},n.prototype.marshalRequest=function(t,n,e){n.query&&-1!==n.query.indexOf("inline-relations-depth")&&(n.query=n.query+"&orphan-relations=1"),e(null,t,n)},n.prototype.marshalResponse=function(n,e,i){if(!n.query||-1===n.query.indexOf("orphan-relations=1")||!e.body.relations||e.body.relations.length<=0){var o=this;return setTimeout(function(){i.call(o,null,e)},1)}var s=[].concat(e.body.resources,t.toArray(e.body.relations));t.each(s,function(n){var i,o=n.entity;for(i in o)if(o.hasOwnProperty(i)){var s=i.match(/(.+)_guid$/);if(s&&2===s.length){var a=s[1],l=o[i],r=e.body.relations[l];r&&(o[a]=r)}var c=i.match(/(.+)_url/);if(c&&2===c.length){var u=c[1],f=o[u];if(f&&f.length>0){var h=[];t.each(f,function(t){var n=e.body.relations[t];n&&h.push(n)}),o[u]=h}}}}),i(null,e)}}}});
//# sourceMappingURL=api-extension.js.map